import { newprocessNodeButtonsAndGenerateHandlers } from './newprocessNodeButtonsAndGenerateHandlers';

/**
 * Обрабатывает кнопки узлов и генерирует обработчики callback-запросов для Telegram бота.
 *
 * Эта функция является ключевым компонентом генератора ботов, который:
 * - Перебирает все inline узлы и их кнопки
 * - Создает уникальные обработчики для callback-запросов кнопок
 * - Избегает дублирования обработчиков для одинаковых callback_data
 * - Генерирует Python код для обработки различных типов кнопок и узлов
 * - Поддерживает множественные типы узлов (message, sticker, voice, animation, location, contact, user-input, start, command)
 * - Реализует логику множественного выбора с кнопкой "Готово"
 * - Обрабатывает условные сообщения и клавиатуры
 * - Управляет состоянием ожидания пользовательского ввода
 *
 * @param processedCallbacks - Set для отслеживания уже обработанных callback_data,
 *                             предотвращает создание дублирующих обработчиков
 *
 * Основные блоки логики:
 * 1. Обработка кнопок с действием 'goto' - создание обработчиков для навигации между узлами
 * 2. Обработка множественного выбора - логика кнопки "Готово" при выборе нескольких опций
 * 3. Генерация обработчиков для различных типов целевых узлов (message, sticker, voice, etc.)
 * 4. Поддержка условных сообщений на основе данных пользователя
 * 5. Обработка прикрепленных медиа и различных типов контента
 * 6. Управление состоянием ожидания пользовательского ввода
 * 7. Обработка специальных медиа-узлов (стикеры, голос, анимации, локация, контакты)
 * 8. Обработка узлов пользовательского ввода с валидацией
 * 9. Обработка start узлов - начальные сообщения
 * 10. Обработка command узлов - выполнение команд
 * 11. Универсальный обработчик для остальных типов узлов
 * 12. Fallback обработка кнопок без настроенной цели
 * 13. Обработка кнопок с действием 'command' - создание обработчиков для выполнения команд
 */
export function processNodeButtonsAndGenerateHandlers(
  inlineNodes: any[],
  processedCallbacks: Set<string>,
  nodes: any[],
  code: string,
  allNodeIds: string[],
  connections: any[],
  mediaVariablesMap: Map<string, any>
) {
  return newprocessNodeButtonsAndGenerateHandlers(inlineNodes, processedCallbacks, nodes, code, allNodeIds, connections, mediaVariablesMap);
}