# Uploads

Папка для загруженных пользователями файлов и медиаконтента.

## Структура

### Организация по пользователям
Файлы организованы по ID пользователей:
- `1/` - файлы пользователя с ID 1
- `2/` - файлы пользователя с ID 2
- и т.д.

### Организация по датам
Внутри папки каждого пользователя файлы группируются по датам:
- `2025-07-07/` - файлы, загруженные 7 июля 2025
- `2025-07-08/` - файлы, загруженные 8 июля 2025

### Примеры файлов
- `1751919935977-360494373.jpg` - изображение с уникальным именем

## Формат именования файлов

### Схема именования
```
{timestamp}-{random_id}.{extension}
```

Где:
- `timestamp` - временная метка в миллисекундах
- `random_id` - случайный идентификатор для уникальности
- `extension` - расширение файла (jpg, png, pdf, etc.)

### Примеры
- `1751919935977-360494373.jpg` - изображение JPEG
- `1751919935978-360494374.png` - изображение PNG
- `1751919935979-360494375.pdf` - PDF документ

## Поддерживаемые типы файлов

### Изображения
- `.jpg`, `.jpeg` - JPEG изображения
- `.png` - PNG изображения
- `.gif` - GIF анимации
- `.webp` - WebP изображения
- `.svg` - SVG векторная графика

### Документы
- `.pdf` - PDF документы
- `.doc`, `.docx` - Microsoft Word документы
- `.txt` - текстовые файлы
- `.md` - Markdown файлы

### Аудио
- `.mp3` - MP3 аудио
- `.wav` - WAV аудио
- `.ogg` - OGG аудио

### Видео
- `.mp4` - MP4 видео
- `.avi` - AVI видео
- `.mov` - QuickTime видео

## Ограничения

### Размер файлов
- Максимальный размер файла: 50 МБ
- Рекомендуемый размер для изображений: до 10 МБ

### Безопасность
- Все файлы проверяются на вирусы
- Запрещены исполняемые файлы (.exe, .bat, .sh)
- Проверяется MIME-тип файлов

## API для работы с файлами

### Загрузка файла
```javascript
POST /api/upload
Content-Type: multipart/form-data

// FormData с файлом
const formData = new FormData();
formData.append('file', file);
formData.append('userId', userId);
```

### Получение файла
```javascript
GET /api/files/{fileId}
```

### Удаление файла
```javascript
DELETE /api/files/{fileId}
```

## Очистка файлов

### Автоматическая очистка
- Файлы старше 30 дней автоматически удаляются
- Неиспользуемые файлы удаляются через 7 дней

### Ручная очистка
```bash
# Очистка файлов старше 30 дней
npm run cleanup:files

# Очистка всех временных файлов
npm run cleanup:temp
```

## Резервное копирование

- Файлы автоматически копируются в облачное хранилище
- Создаются ежедневные резервные копии
- Хранятся резервные копии за последние 30 дней