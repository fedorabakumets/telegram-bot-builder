# Директория ботов

В этой директории размещаются файлы ботов, созданные с помощью конструктора.

## Происхождение ботов

Боты генерируются автоматически основным приложением на основе данных, предоставленных пользователем в веб-интерфейсе. Каждый бот представляет собой отдельный процесс, который может быть запущен и остановлен независимо.

## Структура директории

Файлы ботов создаются в отдельных папках по шаблону `bot_{ID_проекта}_{ID_токена}`, каждая из которых содержит полный набор файлов для соответствующего бота.

Пример иерархии для двух ботов, относящихся к разным проектам или имеющих разные токены:

```
bots/
├── bot_1_12345/
│   ├── bot_1_12345.py          # Основной исполняемый файл бота
│   ├── README.md               # Документация бота
│   ├── requirements.txt        # Зависимости Python
│   ├── Dockerfile              # Для контейнеризации
│   ├── config.yaml             # Конфигурационный файл
│   └── project.json            # JSON-представление проекта
├── bot_2_67890/
│   ├── bot_2_67890.py          # Основной исполняемый файл бота
│   ├── README.md               # Документация бота
│   ├── requirements.txt        # Зависимости Python
│   ├── Dockerfile              # Для контейнеризации
│   ├── config.yaml             # Конфигурационный файл
│   └── project.json            # JSON-представление проекта
└── README.md
```

## Описание файлов

Каждый бот в своей папке содержит следующие файлы:

### `bot_{ID_проекта}_{ID_токена}.py`
- **Назначение**: Основной исполняемый файл бота, содержащий всю его логику
- **Генерируется**: Да, при запуске бота
- **Описание**: Содержит Python-код бота, сгенерированный на основе данных проекта

### `README.md`
- **Назначение**: Документация бота
- **Генерируется**: Да, при запуске бота
- **Описание**: Содержит описание бота, команды, инструкции по установке и настройке

### `requirements.txt`
- **Назначение**: Зависимости Python
- **Генерируется**: Да, при запуске бота
- **Описание**: Список Python-пакетов, необходимых для работы бота

### `Dockerfile`
- **Назначение**: Для контейнеризации
- **Генерируется**: Да, при запуске бота
- **Описание**: Инструкции для создания Docker-образа бота

### `config.yaml`
- **Назначение**: Конфигурационный файл
- **Генерируется**: Да, при запуске бота
- **Описание**: Содержит настройки бота в формате YAML

### `project.json`
- **Назначение**: JSON-представление проекта
- **Генерируется**: Да, при запуске бота
- **Описание**: Содержит JSON-представление структуры проекта бота

## Что означают цифры в названии папки?

Название папки `bot_{ID_проекта}_{ID_токена}` содержит два уникальных идентификатора:

- **`ID_проекта`**: Уникальный номер вашего проекта в конструкторе ботов.
- **`ID_токена`**: Уникальный номер токена, который вы добавили в систему для этого бота.

**Важно:** Эти номера присваиваются базой данных и являются **постоянными**. Если вы удалите токен с ID, равным `7`, а затем добавите новый, он получит ID `8` (или следующий по порядку), а номер `7` больше никогда не будет использоваться. Поэтому не удивляйтесь, если у вашего единственного бота ID токена больше `1` — это нормальное поведение системы, которое гарантирует целостность данных.

## Как добавить новый тип файла

Для добавления нового типа файла, который будет генерироваться для каждого бота, выполните следующие шаги:

1. **Создайте генератор файла** в клиентской части приложения (обычно в `client/src/lib/scaffolding/`)
   - Создайте новую функцию, которая генерирует содержимое файла
   - Например, `generateNewFileType.ts`

2. **Обновите функцию `createCompleteBotFiles`** в `server/createBotFile.ts`
   - Добавьте вызов нового генератора
   - Добавьте сохранение нового файла в папку бота

Пример добавления нового файла:

```typescript
// В server/createBotFile.ts
// Добавьте новый файл в функцию createCompleteBotFiles:

// 6. Новый тип файла
const newFileContent = generateNewFileType(botName, botData); // вызов нового генератора
const newFilePath = join(botDir, 'new-file.ext'); // путь к новому файлу
writeFileSync(newFilePath, newFileContent);
assets.push(newFilePath);
```

3. **Обновите документацию**, если необходимо

Таким образом, любые новые файлы будут автоматически генерироваться для каждого бота при его запуске.